---
title: "Global Data on Sustainable Energy (2000-2020)"
author: "Sujan Bhattarai"
format: html
editor: visual
---

The required data is download from the Kaggle

(link: https://www.kaggle.com/datasets/anshtanwar/global-data-on-sustainable-energy)

Research questions:

# **Potential Use cases**

1.  **Energy Consumption Prediction:** Predict future energy usage, aid planning, and track SDG 7 progress.

2.  **Carbon Emission Forecasting:** Forecast CO2 emissions, support climate strategies.

3.  **Energy Access Classification:** Categorize regions for infrastructure development, understand sustainable energy's role.

4.  **Sustainable Development Goal Tracking:** Monitor progress towards Goal 7, evaluate policy impact.

5.  **Energy Equity Analysis:** Analyze access, density, and growth for equitable distribution.

6.  **Energy Efficiency Optimization:** Identify intensive areas for environmental impact reduction.

7.  **Renewable Energy Potential Assessment:** Identify regions for green investments based on capacity.

8.  **Renewable Energy Investment Strategies:** Guide investors towards sustainable opportunities.

Load required libraries

```{r  message=FALSE, warning=FALSE}
library(tidyverse)
library(here)
library(janitor)
library(rnaturalearth)
library(sf)
```

Read the data, view first few columns, and sum the NA values for each column

```{r  message=FALSE, warning=FALSE}
energy_data <- read_csv(here("raw_data","energy_data.csv"))

head(energy_data)
data.frame(total_NA_count = colSums(is.na(energy_data)))
```

Check the class of each columns

```{r}
##build function to check columns class iteratively
for (i in seq_along(energy_data)){
  print(class(energy_data[[i]]))
}
```

Data-type is in correct format except for country. Change the column type. (This code should change data type and it is vital to run this before moving to next step)

```{r}
for (i in seq_along(energy_data)){
  if(class(energy_data[[i]]) == "character"){
    energy_data[[i]] = as.factor(energy_data[[i]])
  }else
    energy_data[[i]] = as.numeric(energy_data[[i]])
}
```

Shorten column names from energy_data. Short names are better for labeling in visualization

```{r}
energy_data <- energy_data %>%
  rename( popElectric = "Access to electricity (% of population)",
          cleanfuels = "Access to clean fuels for cooking",
          renewable_elec_cap =  "Renewable-electricity-generating-capacity-per-capita",
          finance_flow = "Financial flows to developing countries (US $)",
          renewable_inTotal= "Renewable energy share in the total final energy consumption (%)",
          fossil_eng= "Electricity from fossil fuels (TWh)",
          n_elece = "Electricity from nuclear (TWh)",
          electric = "Low-carbon electricity (% electricity)",
          electric_re = "Electricity from renewables (TWh)",
          energy_cap = "Primary energy consumption per capita (kWh/person)",
          energy_in = "Energy intensity level of primary energy (MJ/$2017 PPP GDP)",
          co2_emis = "Value_co2_emissions_kt_by_country",
          renewables = "Renewables (% equivalent primary energy)",
          gdp = "gdp_growth",
          gdp_cap = "gdp_per_capita",
          pop_density = "Density\\n(P/Km2)",
          land_area = "Land Area(Km2)",
          Lat = "Latitude",
          Lon = "Longitude")
```

Visual representation of the raw data

```{r}
world_map <- ne_countries(returnclass = "sf", scale = "medium")
map <- world_map %>% 
       ggplot() +
       geom_sf()
```

Join the raw energy data with the global data based on ID

```{r  message=FALSE, warning=FALSE}
joined <- right_join(world_map,energy_data,
                     by=c("sovereignt"="Entity")) %>% 
          filter(Year==2020)

for (i in which(colnames(joined)=="Year"): which(colnames(joined)=="pop_density")){
  maps <- world_map %>% 
    st_transform(crs="+proj=robin") %>% 
    ggplot()+
    geom_sf(color="darkgrey")+
    geom_sf(data=joined, aes(fill=joined[[i+1]]))+
    xlab(colnames(joined[i+1][1]))+
    theme(legend.title= element_text("none"))
  print(maps)
}

```

Correlation to see association between variables

```{r}
data_for_correlation <- as.matrix(energy_data[10:length(energy_data)])
corrplot::corrplot(cor(data_for_correlation, use = 'na'),
                   method = "ellipse",
                   title  = "Correlation between variables in Energy data",
                   tl.col = "black")
```
